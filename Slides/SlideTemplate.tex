% set font theme
\usefonttheme{structurebold}

\usepackage{tikz}
% \RequirePackage{pgfopts}
% \RequirePackage{etoolbox}
\usepackage{fontawesome}


% color definitions for template -----------------------------------------------
\usepackage{xcolor}
% \definecolor{EMCdark}{RGB}{12, 32, 116}
\definecolor{EMClight}{RGB}{134, 210, 237}
\definecolor{darkred}{RGB}{204,0,0}
\definecolor{EMCdark}{HTML}{0c2074}
\definecolor{EMC80}{HTML}{3d4d90}
\definecolor{EMC60}{HTML}{6d79ac}
\definecolor{EMC40}{HTML}{9ea6c7}
\definecolor{EMC20}{HTML}{ced2e3}

\definecolor{highlight}{HTML}{e9f7fc}
% \definecolor{struc10}{structure!10}


\setbeamercolor{frametitle}{%
  use=normal text,
  parent=normal text,
  fg=EMCdark,
  bg=white
}

\setbeamercolor*{structure}{bg=white,fg=EMCdark}
\setbeamercolor*{palette primary}{use=structure,fg=white,bg=structure.fg}


% Definition for blocks --------------------------------------------------------
\setbeamercolor{block body}{bg=structure!10}
\setbeamercolor{block title}{bg=structure!20}
\setbeamertemplate{blocks}[rounded][shadow]

% font settings ----------------------------------------------------------------
\usepackage[defaultfam,tabular,lining]{montserrat}
\usepackage[Symbol]{upgreek}

\usepackage[T1]{fontenc}
\renewcommand*\oldstylenums[1]{{\fontfamily{Montserrat-TOsF}\selectfont #1}}
% end of font settings ---------------------------------------------------------

% settings title page ----------------------------------------------------------
% adapted from beamerbasetitle.sty
\makeatletter
% some of this syntax is probably nonsense. I just copied it from the defintion
% of \author and replaced author with email, but don't fully understand what
% everything does
\def\email{\@dblarg\beamer@email}
\long\def\beamer@email[#1]#2{%
  \def\insertemail{\def\inst{\beamer@insttitle}\def\and{\beamer@andtitle}#2}%
  \def\beamer@shortemail{#1}%
  \ifbeamer@autopdfinfo%
    \def\beamer@andstripped{}%
    \beamer@stripands#2 \and\relax
    {\let\inst=\@gobble\let\thanks=\@gobble\def\and{, }}
  \fi%
}

\makeatother

\setbeamerfont{title}{size = \LARGE, series=\bfseries}
\setbeamerfont{subtitle}{size = \Large, series=\bfseries}


\setbeamercolor{title}{fg = EMCdark}
\setbeamercolor{subtitle}{fg = EMCdark}
\setbeamercolor{author}{fg = EMCdark}


\setbeamertemplate{title page}{
\begin{tikzpicture}[remember picture,overlay]
\node[anchor=west] (topdots) at ([xshift=-10.1pt, yshift=-5pt]current page.north west)
    {\includegraphics[width=1.013\paperwidth]{TemplateGraphics/blokjes.png}};

\node[anchor=north] 
  at ([yshift=-20pt]topdots.south) (title)
  {\parbox{\linewidth}{\centering
  \usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}};
\node[anchor=center] 
  at ([yshift=-20pt]title.south) (subtitle)
  {\parbox{\linewidth}{\centering
  \usebeamerfont{subtitle}\usebeamercolor[fg]{title}\insertsubtitle}};
    
\node[anchor=center]
  at ([yshift=-25pt]subtitle.south) (author)
  {\usebeamerfont{author}\usebeamercolor[fg]{title}\insertauthor};
  
\node[anchor=center] 
  at ([yshift=-10pt]author.south) (institute)
  {\usebeamerfont{institute}{\insertinstitute}};

\node[anchor=center]
  at ([yshift=-10pt]institute.south) (email)
  {\usebeamerfont{institute}{\insertemail}};


\node[anchor=east] at ([yshift=15pt]current page.south east)
    {\includegraphics[width=0.153\paperwidth]{TemplateGraphics/logo-erasmusmc-rgb-uk.png}};
\node[anchor=west] at ([xshift=-5.1pt, yshift=15pt]current page.south west) (bottomdots)
    {\includegraphics[width=0.85\paperwidth]{TemplateGraphics/blokjes4.png}};

\node[anchor=center] 
  at ([yshift=50pt]current page.south) (date)
  {\usebeamerfont{date}\usebeamercolor[fg]{title}\insertdate};
\end{tikzpicture}
}


% end of title page definition -------------------------------------------------

% add frame number to footline
\setbeamertemplate{footline}{
  \hfill%
  \usebeamercolor[fg]{page number in head/foot}%
  \usebeamerfont{page number in head/foot}%
  \setbeamertemplate{page number in head/foot}[framenumber]%
  \usebeamertemplate*{page number in head/foot}\kern1em\vskip5pt%
}

\setbeamertemplate{headline}{\vskip3pt}

\setbeamertemplate{frametitle}{%
    \usebeamerfont{frametitle}\insertframetitle%
    \vphantom{g}% To avoid fluctuations per frame
    \vspace*{2pt}
    {\color{EMC20}\hrule}%
    \par%
    \hspace*{-\dimexpr0.5\paperwidth-0.5\textwidth}% <-- calculation of left margin width
}




% commands for columns --------------------------------------------------------
\def\begincols{\begin{columns}}
\def\begincol{\begin{column}}
\def\endcol{\end{column}}
\def\endcols{\end{columns}}


\usepackage{etoolbox} 
\makeatletter 
\preto{\@verbatim}{\topsep=0pt \partopsep=0pt } 
\makeatother


% other definitions ------------------------------------------------------------
% definition for link button
\usepackage{tcolorbox}
\newtcbox{\buttonbox}{colback=EMC80, colframe = EMCdark, coltext = white,
size = fbox, nobeforeafter, on line}
\def\button#1#2{\href{#1}{\buttonbox{\footnotesize\textbf{#2}}}}


% definition for dark blue & bold highlighting
\def\blue#1{{\color{EMCdark}\textbf{#1}}}

\usepackage{pifont} % for \ding{} (arrow)


% R syntax styling (copied from what knitr does) -------------------------------
% \def\Rarg#1{\texttt{{#1}}}
% \def\Rstring#1{\texttt{{#1}}}
\def\Robj#1{\texttt{{#1}}}
\def\Rval#1{\texttt{{#1}}}
\newcommand{\Rfct}[2][]{\texttt{{#2}{(#1)}}}

\def\Rarg#1{\texttt{\DataTypeTok{#1}}}
\def\Rstring#1{\texttt{\StringTok{#1}}}
\def\hlstd#1{#1}
\def\hlstr#1{#1}
\def\hlkwc#1{#1}
\def\hlkwd#1{#1}
\def\hlnum#1{#1}
% \def\Robj#1{\texttt{\hlstd{#1}}}
% \def\Rval#1{\texttt{\hlnum{#1}}}
% \newcommand{\Rfct}[2][]{\texttt{\hlkwd{#2}\hlstd{(#1)}}}
% end of R syntax styling ------------------------------------------------------



\usepackage{soul} %% needed for strike-through and maybe for highlighting
\sethlcolor{highlight}
\renewcommand<>{\hl}[1]{\only#2{\beameroriginal{\hl}}{#1}}

% https://tex.stackexchange.com/questions/41683/why-is-it-that-coloring-in-soul-in-beamer-is-not-visible
\makeatletter
\newcommand\SoulColor{%
  \let\set@color\beamerorig@set@color
  \let\reset@color\beamerorig@reset@color}
\makeatother
\SoulColor



\hypersetup{colorlinks, linkcolor=, urlcolor=EMC80}


